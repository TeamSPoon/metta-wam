<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd"
>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"
>
<title></title>
<style type="text/css"
>
.ansi2html-content { display: inline; white-space: pre-wrap; word-wrap: break-word; }
.body_foreground { color: #AAAAAA; }
.body_background { background-color: #000000; }
.inv_foreground { color: #000000; }
.inv_background { background-color: #AAAAAA; }
.ansi1 { font-weight: bold; }
.ansi31 { color: #aa0000; }
.ansi32 { color: #00aa00; }
.ansi36 { color: #00aaaa; }
.ansi38-255165009 { color: #FFA509; }
.ansi38-255238088 { color: #FFEE58; }
.ansi38-013099040 { color: #0D6328; }
.ansi38-255165009 { color: #FFA509; }
.ansi38-255238088 { color: #FFEE58; }
.ansi38-013099040 { color: #0D6328; }
.ansi38-255165009 { color: #FFA509; }
.ansi38-255238088 { color: #FFEE58; }
.ansi38-013099040 { color: #0D6328; }
</style>
</head>
<body class="body_foreground body_background" style="font-size: normal;" >
<pre class="ansi2html-content"
>
Script started on 2024-09-24 01:50:40+00:00 [TERM="xterm-256color" TTY="/dev/pts/0" COLUMNS="-1" LINES="-1"]
P;HTML|
;           (set_option_value  prolog false)

P;HTML|
;           (set_option_value  compat auto)

P;HTML|
;           (set_option_value  compatio true)
P;HTML|
;            (is_cmd_option  prescan halt --halt=true true)
P;HTML|
;            (set_option_value  halt true)
P;HTML|
;            (is_cmd_option  prescan stdin --stdin=tty tty)
P;HTML|
;             (set_option_value  stdin tty)
P;HTML|
;            (is_cmd_option  prescan stdout --stdout=tty tty)
P;HTML|
;             (set_option_value  stdout tty)
P;HTML|
;            (is_cmd_option  prescan stderr --stderr=tty tty)
P;HTML|
;             (set_option_value  stderr tty)
P;HTML|
;            (set_option_value  prolog false)
P;HTML|
;            (set_option_value  compat auto)
P;HTML|
;            (set_option_value  compatio true)
P;HTML|
;          (is_cmd_option  execute python --python=enable enable)
P;HTML|
;           (set_option_value  python enable)
P;HTML|
;          (is_cmd_option  execute timeout --timeout=40 40)
P;HTML|
;           (set_option_value  timeout 40)
P;HTML|
;           (is_cmd_option  execute output --output=./reports/tests_output/baseline-compat-2024-09-24T00:34:03/ ./reports/tests_output/baseline-compat-2024-09-24T00:34:03/)
P;HTML|
;           (set_option_value  output ./reports/tests_output/baseline-compat-2024-09-24T00:34:03/)
P;HTML|
;           (is_cmd_option  execute html --html true)
P;HTML|
;            (set_option_value  html true)
P;HTML|
;           (is_cmd_option  execute test --test true)
P;HTML|
;            (set_option_value  test true)

; (load_metta_file  &self tests/features/debugging/hyperon_experimental_issue_481.metta)
P;HTML|
;                         (track_load_into_file  /home/runner/work/metta-wam/metta-wam/tests/features/debugging/hyperon_experimental_issue_481.metta)
P;HTML|
;                                          (load_answer_file  /home/runner/work/metta-wam/metta-wam/tests/features/debugging/hyperon_experimental_issue_481.metta.answers /home/runner/work/metta-wam/metta-wam/tests/features/debugging/hyperon_experimental_issue_481.metta)
P;HTML|
;                                           (= 1  "Doing: timeout --foreground --kill-after=5 --signal=SIGINT 61 time metta /opt/logicmoo_workspace/packs_sys/logicmoo_opencog/MeTTa/hyperon-wam/reports/features/debugging/hyperon_experimental_issue_481.metta")
P;HTML|
;                                           (= 1  "[False]")
P;HTML|
;                                           (= 2  "[((Error (superpose Empty) superpose expects single expression as an argument))]")
P;HTML|
;                                           (= 3  "[(Empty)]")
P;HTML|
;                                           (= 4  "0.07user 0.01system 0:00.08elapsed 100%CPU (0avgtext+0avgdata 33308maxresident)k")
P;HTML|
;                                           (= 4  "0inputs+0outputs (0major+3635minor)pagefaults 0swaps")
P;HTML|
;                                          (load_answer_file  /home/runner/work/metta-wam/metta-wam/tests/features/debugging/hyperon_experimental_issue_481.metta.answers /home/runner/work/metta-wam/metta-wam/tests/features/debugging/hyperon_experimental_issue_481.metta)

;;; https://github.com/trueagi-io/hyperon-experimental/issues/481
;;;patham9 commented on Nov 1, 2023 â€¢
;;;Clearly there is no way for the following collapse to have any item:
<span class="ansi38-255165009"
>;; In file as:  
</span><span class="ansi1 ansi38-255238088"
>  !(== () 
    (collapse (let* (($L ()) ($x (superpose $L))) $x)))
</span>;; To unit test case:
<span class="ansi38-013099040"
>  !(assertEqualToResult 
    (== () 
      (collapse (let* (($L ()) ($x (superpose $L))) $x))) 
    (False))

</span>[

;<h3 id="DEBUGGING.HYPERON-EXPERIMENTAL-ISSUE-481.01"
>;; DEBUGGING.HYPERON-EXPERIMENTAL-ISSUE-481.01</h3>
; 
; EVAL TEST
; took 0.001 secs. (1.00 milliseconds) 

  !(assertEqualToResult 
    (== () 
      (collapse (let* (($L ()) ($x (superpose $L))) $x))) 
    (False))

<span class="ansi31"
>  (loonit_failureR  
    (equal_enough_for_test  
      (True) 
      (False)))
</span>
Deterministic: ((Error  (got  (True)) (expected  (False))))
((Error  (got  (True)) (expected  (False))))]
;;;Yet:
;;;Output: [False]
;;;Expected: [True]
;;;MeTTa leaves the let* expression unevaluated in this case, which leaves the collapse with a "pseudo-item", an expression with variables, which leads to the comparison to return false even though there cannot be any variable assignment that actually satisfies the let* expression.
;;; vsbogd commented on Nov 2, 2023
;;;Regarding minimal MeTTa, we have Empty symbol there to represent an empty result. Using it we could potentially properly fix superpose to return Empty from (superpose Empty) call. Thus the example above will turn into:
<span class="ansi38-255165009"
>;; In file as:  
</span><span class="ansi1 ansi38-255238088"
>  !(collapse (let $L  (let $x (superpose $L) $x)))
</span>;; To unit test case:
<span class="ansi38-013099040"
>  !(assertEqualToResult 
    (collapse (let $L  (let $x (superpose $L) $x))) 
    ( ( (Error 
          (superpose ) superpose expects single expression as an argument))))

</span>[

;<h3 id="DEBUGGING.HYPERON-EXPERIMENTAL-ISSUE-481.02"
>;; DEBUGGING.HYPERON-EXPERIMENTAL-ISSUE-481.02</h3>
; 
; EVAL TEST
; took 0.000322 secs. (322.07 microseconds) 

  !(assertEqualToResult 
    (collapse (let $L  (let $x (superpose $L) $x))) 
    ( ( (Error 
          (superpose ) superpose expects single expression as an argument))))

<span class="ansi36"
>  (loonit_success  
    (equal_enough_for_test  
      (()) 
      ( ( (Error 
            (superpose ) superpose expects single expression as an argument)))))
</span>
Deterministic: ()
()]
;;;And collapse will return () in this case. One can "simulate" this on a current version of minimal MeTTa using additional parenthesis:
<span class="ansi38-255165009"
>;; In file as:  
</span><span class="ansi1 ansi38-255238088"
>  !(collapse (let $L () (let $x (superpose $L) $x)))
</span>;; To unit test case:
<span class="ansi38-013099040"
>  !(assertEqualToResult 
    (collapse (let $L () (let $x (superpose $L) $x))) 
    ( ()))

</span>[

;<h3 id="DEBUGGING.HYPERON-EXPERIMENTAL-ISSUE-481.03"
>;; DEBUGGING.HYPERON-EXPERIMENTAL-ISSUE-481.03</h3>
; 
; EVAL TEST
; took 0.000554 secs. (553.54 microseconds) 

  !(assertEqualToResult 
    (collapse (let $L () (let $x (superpose $L) $x))) 
    ( ()))

<span class="ansi36"
>  (loonit_success  
    (equal_enough_for_test  
      (()) 
      ( ())))
</span>
Deterministic: ()
()]
;;; vsbogd commented on Nov 2, 2023
<span class="ansi32"
>% 169,503 inferences, 0.053 CPU in 0.053 seconds (100% CPU, 3212920 Lips)
</span>P;HTML|
;                         (= /home/runner/work/metta-wam/metta-wam/tests/features/debugging/hyperon_experimental_issue_481.metta  0)
<span class="ansi1"
>LoonIt Report
</span>------------
<span class="ansi32"
>Successes: 2
</span><span class="ansi31"
>Failures: 1
</span><br/> <a href="#" onclick="window.history.back(); return false;"
>Return to summaries</a><br/>
P;HTML|
;           (is_cmd_option  execute halt --halt=true true)
P;HTML|
;            (set_option_value  halt true)
P;HTML|
;            (is_cmd_option  execute stdin --stdin=tty tty)
P;HTML|
;            (set_option_value  stdin tty)
P;HTML|
;            (is_cmd_option  execute stdout --stdout=tty tty)
P;HTML|
;             (set_option_value  stdout tty)
P;HTML|
;            (is_cmd_option  execute stderr --stderr=tty tty)
P;HTML|
;             (set_option_value  stderr tty)
P;HTML|
;           (set_option_value  prolog false)
P;HTML|
;           (set_option_value  compat auto)
P;HTML|
;           (set_option_value  compatio true)

Script done on 2024-09-24 01:50:44+00:00 [COMMAND_EXIT_CODE="7"]

</pre>
</body>

</html>
\033[0;32mCompleted successfully (EXITCODE=7) Under 40 seconds: ./mettalog '--output=./reports/tests_output/baseline-compat-2024-09-24T00:34:03/' --timeout=40 --html --repl=false  --test "tests/features/debugging/hyperon_experimental_issue_481.metta" --halt=true\033[0m
