<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd"
>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"
>
<title></title>
<style type="text/css"
>
.ansi2html-content { display: inline; white-space: pre-wrap; word-wrap: break-word; }
.body_foreground { color: #AAAAAA; }
.body_background { background-color: #000000; }
.inv_foreground { color: #000000; }
.inv_background { background-color: #AAAAAA; }
.ansi1 { font-weight: bold; }
.ansi31 { color: #aa0000; }
.ansi36 { color: #00aaaa; }
.ansi38-013099040 { color: #0D6328; }
.ansi38-255165000 { color: #FFA500; }
.ansi38-015015015 { color: #0F0F0F; }
.ansi38-255165000 { color: #FFA500; }
.ansi38-015015015 { color: #0F0F0F; }
.ansi38-013099040 { color: #0D6328; }
.ansi38-013099040 { color: #0D6328; }
.ansi38-013099040 { color: #0D6328; }
.ansi38-255165009 { color: #FFA509; }
.ansi38-255238088 { color: #FFEE58; }
.ansi38-013099040 { color: #0D6328; }
.ansi38-255165000 { color: #FFA500; }
.ansi38-015015015 { color: #0F0F0F; }
.ansi38-255165009 { color: #FFA509; }
.ansi38-255238088 { color: #FFEE58; }
.ansi38-013099040 { color: #0D6328; }
.ansi38-255165000 { color: #FFA500; }
.ansi38-015015015 { color: #0F0F0F; }
.ansi38-255165000 { color: #FFA500; }
.ansi38-015015015 { color: #0F0F0F; }
.ansi38-255165000 { color: #FFA500; }
.ansi38-015015015 { color: #0F0F0F; }
.ansi38-013099040 { color: #0D6328; }
.ansi38-255165000 { color: #FFA500; }
.ansi38-015015015 { color: #0F0F0F; }
.ansi38-255165000 { color: #FFA500; }
.ansi38-015015015 { color: #0F0F0F; }
.ansi38-255165000 { color: #FFA500; }
.ansi38-015015015 { color: #0F0F0F; }
.ansi38-255165000 { color: #FFA500; }
.ansi38-015015015 { color: #0F0F0F; }
.ansi38-255165000 { color: #FFA500; }
.ansi38-015015015 { color: #0F0F0F; }
.ansi38-255165000 { color: #FFA500; }
.ansi38-015015015 { color: #0F0F0F; }
.ansi38-255165000 { color: #FFA500; }
.ansi38-015015015 { color: #0F0F0F; }
.ansi38-255165000 { color: #FFA500; }
.ansi38-015015015 { color: #0F0F0F; }
.ansi38-255165000 { color: #FFA500; }
.ansi38-015015015 { color: #0F0F0F; }
.ansi38-255165000 { color: #FFA500; }
.ansi38-015015015 { color: #0F0F0F; }
.ansi38-255165000 { color: #FFA500; }
.ansi38-015015015 { color: #0F0F0F; }
.ansi38-255165000 { color: #FFA500; }
.ansi38-015015015 { color: #0F0F0F; }
.ansi38-255165000 { color: #FFA500; }
.ansi38-015015015 { color: #0F0F0F; }
.ansi38-255165000 { color: #FFA500; }
.ansi38-015015015 { color: #0F0F0F; }
.ansi38-013099040 { color: #0D6328; }
.ansi38-255165009 { color: #FFA509; }
.ansi38-255238088 { color: #FFEE58; }
.ansi38-013099040 { color: #0D6328; }
.ansi38-255165009 { color: #FFA509; }
.ansi38-255238088 { color: #FFEE58; }
.ansi38-013099040 { color: #0D6328; }
.ansi38-255165009 { color: #FFA509; }
.ansi38-255238088 { color: #FFEE58; }
.ansi38-013099040 { color: #0D6328; }
</style>
</head>
<body class="body_foreground body_background" style="font-size: normal;" >
<pre class="ansi2html-content"
>
Script started on 2024-09-30 01:54:38+00:00 [TERM="xterm-256color" TTY="/dev/pts/0" COLUMNS="-1" LINES="-1"]
P;HTML|
;           (set_option_value  prolog false)

P;HTML|
;           (set_option_value  compat auto)

P;HTML|
;           (set_option_value  compatio true)
P;HTML|
;            (is_cmd_option  prescan halt --halt=true true)
P;HTML|
;            (set_option_value  halt true)
P;HTML|
;            (is_cmd_option  prescan stdin --stdin=tty tty)
P;HTML|
;             (set_option_value  stdin tty)
P;HTML|
;            (is_cmd_option  prescan stdout --stdout=tty tty)
P;HTML|
;             (set_option_value  stdout tty)
P;HTML|
;            (is_cmd_option  prescan stderr --stderr=tty tty)
P;HTML|
;             (set_option_value  stderr tty)
P;HTML|
;            (set_option_value  prolog false)
P;HTML|
;            (set_option_value  compat auto)
P;HTML|
;            (set_option_value  compatio true)
P;HTML|
;          (is_cmd_option  execute python --python=enable enable)
P;HTML|
;           (set_option_value  python enable)
P;HTML|
;          (is_cmd_option  execute timeout --timeout=40 40)
P;HTML|
;           (set_option_value  timeout 40)
P;HTML|
;           (is_cmd_option  execute output --output=./reports/tests_output/baseline-compat-2024-09-30T00:36:13/ ./reports/tests_output/baseline-compat-2024-09-30T00:36:13/)
P;HTML|
;           (set_option_value  output ./reports/tests_output/baseline-compat-2024-09-30T00:36:13/)
P;HTML|
;           (is_cmd_option  execute html --html true)
P;HTML|
;            (set_option_value  html true)
P;HTML|
;           (is_cmd_option  execute test --test true)
P;HTML|
;            (set_option_value  test true)

; (load_metta_file  &self tests/features/iterators/combined.metta)
P;HTML|
;                         (track_load_into_file  /home/runner/work/metta-wam/metta-wam/tests/features/iterators/combined.metta)
P;HTML|
;                                          (load_answer_file  /home/runner/work/metta-wam/metta-wam/tests/features/iterators/combined.metta.answers /home/runner/work/metta-wam/metta-wam/tests/features/iterators/combined.metta)
P;HTML|
;                                           (= 1  "Doing: timeout --foreground --kill-after=5 --signal=SIGINT 61 time metta /opt/logicmoo_workspace/packs_sys/logicmoo_opencog/MeTTa/hyperon-wam/reports/features/iterators/combined.metta")
P;HTML|
;                                           (= 1  "\"Press 'en-ee' key to continue...\"")
P;HTML|
;                                           (= 1  "\"Press 'en-ee' key to continue...\"")
P;HTML|
;                                           (= 1  "[(switch_to_mettalog!)]")
P;HTML|
;                                           (= 2  "[()]")
P;HTML|
;                                           (= 3  "[()]")
P;HTML|
;                                           (= 4  "[()]")
P;HTML|
;                                           (= 5  "[()]")
P;HTML|
;                                           (= 6  "[()]")
P;HTML|
;                                           (= 7  "[()]")
P;HTML|
;                                           (= 8  "[(shell! \"cat neg1_pos1.txt\")]")
P;HTML|
;                                           (= 9  "[((read-metta! (open! \"neg1_pos1.txt\" read)))]")
P;HTML|
;                                           (= 10  "[((read-metta! (open! \"neg1_pos1.txt\" read)))]")
P;HTML|
;                                           (= 11  "[(, () (get-single-char-fn))]")
P;HTML|
;                                           (= 12  "[(let $doubledNumbers#125 (map (* 2) (open! \"neg1_pos1.txt\" read)) (let $combinedStream#126 (zip (map (< 0) (open! \"neg1_pos1.txt\" read)) $doubledNumbers#125) (let $each#127 (materialize! $combinedStream#126) (with-results-to-file \"from_file.txt\" $each#127))))]")
P;HTML|
;                                           (= 13  "[(shell! \"cat from_file.txt\")]")
P;HTML|
;                                           (= 14  "[(, () (get-single-char-fn))]")
P;HTML|
;                                           (= 15  "0.15user 0.00system 0:00.16elapsed 100%CPU (0avgtext+0avgdata 33892maxresident)k")
P;HTML|
;                                           (= 15  "0inputs+0outputs (0major+3775minor)pagefaults 0swaps")
P;HTML|
;                                          (load_answer_file  /home/runner/work/metta-wam/metta-wam/tests/features/iterators/combined.metta.answers /home/runner/work/metta-wam/metta-wam/tests/features/iterators/combined.metta)

<span class="ansi38-013099040"
>  !(switch_to_mettalog!)

</span>[P;HTML|
;                                           (eval_call
;                                             (apply  switch_to_mettalog ()) $TF)


Deterministic: True
True]
;;;;; in case we where not started with --log
<span class="ansi38-255165000"
>  (: wait-for-key 
    (-> Integer))
</span><span class="ansi38-015015015"
>  ; Action: load=metta_atom_asserted('&self',[:,'wait-for-key',[->,'Integer']])

</span>;;; (e)xit
;;; (b)reak
<span class="ansi38-255165000"
>  (= 
    (wait-for-key) 
    (, 
      (println! "Press 'en-ee' key to continue...") 
      (case 
        (get-single-char-fn) 
        ( (101 (halt! 6)) 
          (98 (, (repl!) (wait-for-key))) 
          ($x $x)))))
</span><span class="ansi38-015015015"
>  ; Action: load=metta_atom_asserted('&self',[=,['wait-for-key'],[',',['println!',"Press 'en-ee' key to continue..."],[case,['get-single-char-fn'],[[101,['halt!',6]],[98,[',',['repl!'],['wait-for-key']]],[_x,_x]]]]])

</span>;;; return other ascii codes
<span class="ansi38-013099040"
>  !(pragma! sandbox False)

</span>[P;HTML|
;                                           (set_option_value  sandbox False)


Deterministic: ()
()]
;;;; in case we are in SWISH
<span class="ansi38-013099040"
>  !(pragma! host-functions all)

</span>[P;HTML|
;                                           (set_option_value  host-functions all)


Deterministic: ()
()]
;;;; throw a security exception in SWISH and the user is not logged in
<span class="ansi38-013099040"
>  !(bind! &iter1 
    (new-space))

</span>

Deterministic: ()
[()]
<span class="ansi38-255165009"
>;; In file as:  
</span><span class="ansi1 ansi38-255238088"
>  !(add-atom &iter1 -1)
</span>;; To unit test case:
<span class="ansi38-013099040"
>  !(assertEqualToResult 
    (add-atom &iter1 -1) 
    (()))

</span>[

;<h3 id="ITERATORS.COMBINED.01"
>;; ITERATORS.COMBINED.01</h3>
<span class="ansi38-255165000"
> -1
</span><span class="ansi38-015015015"
>  ; Action: load=metta_atom_asserted('&iter1',-1)

</span>; 
; EVAL TEST
; took 0.001 secs. (1.16 milliseconds) 

  !(assertEqualToResult 
    (add-atom &iter1 -1) 
    (()))

<span class="ansi36"
>  (loonit_success  
    (equal_enough_for_test  
      (()) 
      (())))
</span>
Deterministic: ()
()]
<span class="ansi38-255165009"
>;; In file as:  
</span><span class="ansi1 ansi38-255238088"
>  !(add-atom &iter1 1)
</span>;; To unit test case:
<span class="ansi38-013099040"
>  !(assertEqualToResult 
    (add-atom &iter1 1) 
    (()))

</span>[

;<h3 id="ITERATORS.COMBINED.02"
>;; ITERATORS.COMBINED.02</h3>
<span class="ansi38-255165000"
> 1
</span><span class="ansi38-015015015"
>  ; Action: load=metta_atom_asserted('&iter1',1)

</span>; 
; EVAL TEST
; took 0.001 secs. (1.15 milliseconds) 

  !(assertEqualToResult 
    (add-atom &iter1 1) 
    (()))

<span class="ansi36"
>  (loonit_success  
    (equal_enough_for_test  
      (()) 
      (())))
</span>
Deterministic: ()
()]
;;; Number, Strings, Expressions are values
<span class="ansi38-255165000"
>  (: zip 
    (-> Value Value Expression))
</span><span class="ansi38-015015015"
>  ; Action: load=metta_atom_asserted('&self',[:,zip,[->,'Value','Value','Expression']])

</span><span class="ansi38-255165000"
>  (= 
    (zip $i $j) 
    ($i $j))
</span><span class="ansi38-015015015"
>  ; Action: load=metta_atom_asserted('&self',[=,[zip,_i,_j],[_i,_j]])

</span><span class="ansi38-013099040"
>  !(import! &self ../io/file-output.metta)

</span>[P;HTML|
;                                           (load_answer_file  /home/runner/work/metta-wam/metta-wam/tests/features/io/file-output.metta.answers /home/runner/work/metta-wam/metta-wam/tests/features/io/file-output.metta)
P;HTML|
;                                           (load_answer_file  /home/runner/work/metta-wam/metta-wam/tests/features/io/file-output.metta.answers /home/runner/work/metta-wam/metta-wam/tests/features/io/file-output.metta)

;;;; Captures stdout and sends to a file
<span class="ansi38-255165000"
>  (: with-output-to-file 
    (-> Uri 
      (-> $Ret) $Ret))
</span><span class="ansi38-015015015"
>  ; Action: load=metta_atom_asserted('&self',[:,'with-output-to-file',[->,'Uri',[->,_Ret],_Ret]])

</span><span class="ansi38-255165000"
>  (= 
    (with-output-to-file $name $atom) 
    (let $out 
      (open! $name write) 
      (call-cleanup! 
        (with-output-to! $out 
          (eval $atom)) 
        (close! $out))))
</span><span class="ansi38-015015015"
>  ; Action: load=metta_atom_asserted('&self',[=,['with-output-to-file',_name,_atom],[let,_out,['open!',_name,write],['call-cleanup!',['with-output-to!',_out,[eval,_atom]],['close!',_out]]]])

</span>;;;; Writes results to a stream
<span class="ansi38-255165000"
>  (: with-results-to 
    (-> Writable 
      (-> $Ret) $Ret))
</span><span class="ansi38-015015015"
>  ; Action: load=metta_atom_asserted('&self',[:,'with-results-to',[->,'Writable',[->,_Ret],_Ret]])

</span><span class="ansi38-255165000"
>  (= 
    (with-results-to $stream $eval) 
    (let $res 
      (eval $eval) 
      (, 
        (write-src! $stream $res) 
        (nl! $stream))))
</span><span class="ansi38-015015015"
>  ; Action: load=metta_atom_asserted('&self',[=,['with-results-to',_stream,_eval],[let,_res,[eval,_eval],[',',['write-src!',_stream,_res],['nl!',_stream]]]])

</span>;;;; Captures results of function places them in file
<span class="ansi38-255165000"
>  (: with-results-to-file 
    (-> Uri 
      (-> $Ret) $Ret))
</span><span class="ansi38-015015015"
>  ; Action: load=metta_atom_asserted('&self',[:,'with-results-to-file',[->,'Uri',[->,_Ret],_Ret]])

</span><span class="ansi38-255165000"
>  (= 
    (with-results-to-file $name $atom) 
    (let $out 
      (open! $name write) 
      (call-cleanup! 
        (with-results-to $out $atom) 
        (close! $out))))
</span><span class="ansi38-015015015"
>  ; Action: load=metta_atom_asserted('&self',[=,['with-results-to-file',_name,_atom],[let,_out,['open!',_name,write],['call-cleanup!',['with-results-to',_out,_atom],['close!',_out]]]])

</span>
Deterministic: ()
()]
<span class="ansi38-255165000"
>  (: iterate 
    (-> Atom Atom))
</span><span class="ansi38-015015015"
>  ; Action: load=metta_atom_asserted('&self',[:,iterate,[->,'Atom','Atom']])

</span><span class="ansi38-255165000"
>  (= 
    (iterate $iterable) 
    (case 
      ($iterable (get-mettatype $iterable)) 
      ( ( ($ GroundedSpace) (get-atoms $iterable)) 
        ( ( (fifo $list) $) (superpose $list)) 
        ( ($ $_InputStream) (read-metta $iterable)) 
        ($ $iterable))))
</span><span class="ansi38-015015015"
>  ; Action: load=metta_atom_asserted('&self',[=,[iterate,_iterable],[case,[_iterable,['get-mettatype',_iterable]],[[[__,'GroundedSpace'],['get-atoms',_iterable]],[[[fifo,_list],__],[superpose,_list]],[[__,__InputStream],['read-metta',_iterable]],[__,_iterable]]]])

</span><span class="ansi38-255165000"
>  (: new-space-with 
    (-> Atom Atom))
</span><span class="ansi38-015015015"
>  ; Action: load=metta_atom_asserted('&self',[:,'new-space-with',[->,'Atom','Atom']])

</span>;;; Space
<span class="ansi38-255165000"
>  (= 
    (new-space-with $list) 
    (let $space 
      (new-space) 
      (, 
        (compose (add-atom $space (superpose $fill))) $space)))
</span><span class="ansi38-015015015"
>  ; Action: load=metta_atom_asserted('&self',[=,['new-space-with',_list],[let,_space,['new-space'],[',',[compose,['add-atom',_space,[superpose,_fill]]],_space]]])

</span><span class="ansi38-255165000"
>  (: map 
    (-> Atom Atom Atom))
</span><span class="ansi38-015015015"
>  ; Action: load=metta_atom_asserted('&self',[:,map,[->,'Atom','Atom','Atom']])

</span><span class="ansi38-255165000"
>  (= 
    (map $p2 $itr) 
    (lazy-map! $p2 
      (iterate $itr)))
</span><span class="ansi38-015015015"
>  ; Action: load=metta_atom_asserted('&self',[=,[map,_p2,_itr],['lazy-map!',_p2,[iterate,_itr]]])

</span><span class="ansi38-255165000"
>  (: test-diamond 
    (-> Atom Atom Atom))
</span><span class="ansi38-015015015"
>  ; Action: load=metta_atom_asserted('&self',[:,'test-diamond',[->,'Atom','Atom','Atom']])

</span><span class="ansi38-255165000"
>  (= 
    (test-diamond $filename $iterable) 
    (let $isPositive 
      (map 
        (< 0) $iterable) 
      (let $doubledNumbers 
        (map 
          (* 2) $iterable) 
        (let $combinedStream 
          (zip $isPositive $doubledNumbers) 
          (let $each 
            (materialize! $combinedStream) 
            (with-results-to-file $filename $each))))))
</span><span class="ansi38-015015015"
>  ; Action: load=metta_atom_asserted('&self',[=,['test-diamond',_filename,_iterable],[let,_isPositive,[map,[<,0],_iterable],[let,_doubledNumbers,[map,[*,2],_iterable],[let,_combinedStream,[zip,_isPositive,_doubledNumbers],[let,_each,['materialize!',_combinedStream],['with-results-to-file',_filename,_each]]]]]])

</span>;;;; create our input file
;;;;; !(with-results-to-file "neg1_pos1.txt" (superpose (-1 1 )))
;;;;; !(with-output-to-file "neg1_pos1.txt" (and (println! -1)(println! 1)))
;;;; display and wait 
<span class="ansi38-013099040"
>  !(shell! "cat neg1_pos1.txt")

</span>[P;HTML|
;                                           (eval_call
;                                             (apply  shell
;                                               ("cat neg1_pos1.txt")) $TF)
-1
2


Deterministic: True
True]
;;;!(test-diamond "space.txt" (new-space-with (-1 1)))
;;;!(shell! "cat space.txt")
;;;!(wait-for-key)
;;;!(test-diamond "fifo.txt" (fifo (-1 1)))
;;;!(shell! "cat fifo.txt")
;;;!(wait-for-key)
<span class="ansi38-255165009"
>;; In file as:  
</span><span class="ansi1 ansi38-255238088"
>  !(collapse (read-metta! (open! "neg1_pos1.txt" read)))
</span>;; To unit test case:
<span class="ansi38-013099040"
>  !(assertEqualToResult 
    (collapse (read-metta! (open! "neg1_pos1.txt" read))) 
    ( ( (read-metta! (open! "neg1_pos1.txt" read)))))

</span>[

;<h3 id="ITERATORS.COMBINED.03"
>;; ITERATORS.COMBINED.03</h3>
; 
; EVAL TEST
; took 0.000683 secs. (682.73 microseconds) 

  !(assertEqualToResult 
    (collapse (read-metta! (open! "neg1_pos1.txt" read))) 
    ( ( (read-metta! (open! "neg1_pos1.txt" read)))))

<span class="ansi31"
>  (loonit_failureR  
    (equal_enough_for_test  
      ( (-1)) 
      ( ( (read-metta! (open! "neg1_pos1.txt" read))))))
</span>
Deterministic: ((Error  (got  ((-1))) (expected  (((read-metta! (open! "neg1_pos1.txt" read)))))))
((Error  (got  ((-1))) (expected  (((read-metta! (open! "neg1_pos1.txt" read)))))))]
<span class="ansi38-255165009"
>;; In file as:  
</span><span class="ansi1 ansi38-255238088"
>  !(let $stream 
    (open! "neg1_pos1.txt" read) 
    (collapse (read-metta! $stream)))
</span>;; To unit test case:
<span class="ansi38-013099040"
>  !(assertEqualToResult 
    (let $stream 
      (open! "neg1_pos1.txt" read) 
      (collapse (read-metta! $stream))) 
    ( ( (read-metta! (open! "neg1_pos1.txt" read)))))

</span>[

;<h3 id="ITERATORS.COMBINED.04"
>;; ITERATORS.COMBINED.04</h3>
; 
; EVAL TEST
; took 0.000682 secs. (681.90 microseconds) 

  !(assertEqualToResult 
    (let $stream 
      (open! "neg1_pos1.txt" read) 
      (collapse (read-metta! $stream))) 
    ( ( (read-metta! (open! "neg1_pos1.txt" read)))))

<span class="ansi31"
>  (loonit_failureR  
    (equal_enough_for_test  
      ( (-1)) 
      ( ( (read-metta! (open! "neg1_pos1.txt" read))))))
</span>
Deterministic: ((Error  (got  ((-1))) (expected  (((read-metta! (open! "neg1_pos1.txt" read)))))))
((Error  (got  ((-1))) (expected  (((read-metta! (open! "neg1_pos1.txt" read)))))))]
<span class="ansi38-255165009"
>;; In file as:  
</span><span class="ansi1 ansi38-255238088"
>  !(wait-for-key)
</span>;; To unit test case:
<span class="ansi38-013099040"
>  !(assertEqualToResult 
    (wait-for-key) 
    ( (, () 
        (get-single-char-fn))))

</span>[

;<h3 id="ITERATORS.COMBINED.05"
>;; ITERATORS.COMBINED.05</h3>
Press 'en-ee' key to continue...

Script done on 2024-09-30 01:55:18+00:00 [COMMAND_EXIT_CODE="143"]

</pre>
</body>

</html>
\033[1;33mCompleted (EXITCODE=143) Under 40 seconds: ./mettalog '--output=./reports/tests_output/baseline-compat-2024-09-30T00:36:13/' --timeout=40 --html --repl=false  --test "tests/features/iterators/combined.metta" --halt=true\033[0m
